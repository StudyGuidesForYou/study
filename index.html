<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Classroom Launcher</title>

<!-- Preconnect for worker performance -->
<link rel="preconnect" href="https://wild-bonus-f4be.very-cool-email2001-785.workers.dev" crossorigin>

<style>
/* ===== YOUR ORIGINAL DESIGN (PRESERVED EXACTLY) ===== */
html, body {
  margin: 0;
  padding: 0;
  background: #0d101a;
  color: white;
  font-family: Arial, sans-serif;
  height: 100%;
  overflow: hidden;
}

/* Container */
#main-shell {
  position: absolute;
  top:0; left:0; right:0; bottom:0;
  display:flex;
  flex-direction:column;
  backdrop-filter: blur(25px) brightness(1.1);
}

/* Search bar */
#topbar {
  display:flex;
  padding:10px;
  background: rgba(255,255,255,0.05);
  align-items:center;
  justify-content:space-between;
}

#urlInput {
  width:70%;
  padding:10px;
  border-radius:10px;
  border:none;
  outline:none;
  background:rgba(255,255,255,0.15);
  color:white;
}

/* Buttons */
.ctrl-btn {
  cursor:pointer;
  padding:10px;
  background:rgba(255,255,255,0.1);
  border-radius:8px;
  margin-left:8px;
  user-select:none;
}
.ctrl-btn:hover {
  background:rgba(255,255,255,0.18);
}

/* Iframe area */
#frame-shell {
  flex:1;
  position:relative;
  overflow:hidden;
}

#mainFrame {
  position:absolute;
  top:0; left:0; right:0; bottom:0;
  width:100%;
  height:100%;
  border:none;
}

/* Fallback overlay */
#fallback-shell {
  position:absolute;
  top:0; left:0; right:0; bottom:0;
  display:none;
  align-items:center;
  justify-content:center;
  background:#0d101a;
  flex-direction:column;
  text-align:center;
  padding:20px;
}

#fallback-shell button {
  padding:12px 18px;
  font-size:16px;
  background:rgba(255,255,255,0.12);
  border:none;
  border-radius:10px;
  color:white;
  cursor:pointer;
  margin:5px;
}
#fallback-shell button:hover {
  background:rgba(255,255,255,0.2);
}

</style>
</head>
<body>

<div id="main-shell">
  
  <!-- Top Bar -->
  <div id="topbar">
    <input id="urlInput" placeholder="Enter a URL..." />

    <div class="top-actions" style="display:flex;align-items:center;">
      <div class="ctrl-btn" id="goBtn">Go</div>
      <div class="ctrl-btn" id="reloadBtn">⟳</div>
      <div class="ctrl-btn" id="fullscreenBtn">⛶</div>
      <!-- ADDED: mobile menu btn (fix for your JS) -->
      <div class="ctrl-btn" id="mobileMenuBtn" title="Menu" style="display:none">☰</div>
    </div>
  </div>

  <!-- Iframe -->
  <div id="frame-shell">
    <iframe id="mainFrame"></iframe>

    <!-- Fallback -->
    <div id="fallback-shell">
      <h2>Site failed to load</h2>
      <p id="fallbackUrl"></p>
      <button id="openOriginal">Open original</button>
      <button id="openWorker">Open via worker</button>
    </div>
  </div>

</div>


<script>
/* ============= SETTINGS ============= */
const WORKER_BASE = "https://wild-bonus-f4be.very-cool-email2001-785.workers.dev";
const LOAD_TIMEOUT_MS = window.innerWidth < 800 ? 5000 : 6500;

/* UI refs */
const frame = document.getElementById("mainFrame");
const input = document.getElementById("urlInput");
const fallback = document.getElementById("fallback-shell");
const fallbackUrl = document.getElementById("fallbackUrl");

/* Convert URL to worker proxied version */
function toProxy(u) {
  return WORKER_BASE + "/proxy?target=" + encodeURIComponent(u);
}

/* Normalizer */
function normalizeUrl(u) {
  try {
    if (!/^https?:\/\//i.test(u)) return "https://" + u;
    return u;
  } catch {
    return "https://" + u;
  }
}

/* Open URL in iframe with fallback */
async function loadURL(raw) {
  fallback.style.display = "none";

  const original = normalizeUrl(raw);
  const workerURL = toProxy(original);

  input.value = original;
  frame.src = original;

  const loadPromise = new Promise((resolve, reject) => {
    let done = false;

    const timer = setTimeout(() => {
      if (!done) {
        done = true;
        reject();
      }
    }, LOAD_TIMEOUT_MS);

    frame.onload = () => {
      if (!done) {
        done = true;
        resolve();
      }
    };
  });

  try {
    await loadPromise;
  } catch {
    // show fallback UI
    fallback.style.display = "flex";
    fallbackUrl.textContent = original;

    document.getElementById("openOriginal").onclick = () =>
      window.open(original, "_blank", "noopener,noreferrer");

    document.getElementById("openWorker").onclick = () =>
      window.open(workerURL, "_blank", "noopener,noreferrer");
  }
}

/* ============= EVENTS ============= */
document.getElementById("goBtn").onclick = () => loadURL(input.value);
document.getElementById("reloadBtn").onclick = () => {
  if (frame.src) frame.src = frame.src;
};
document.getElementById("fullscreenBtn").onclick = () => {
  if (frame.requestFullscreen) frame.requestFullscreen();
};

/* MOBILE MENU HANDLER — fixes the bug */
const mobileMenuBtn = document.getElementById("mobileMenuBtn");
mobileMenuBtn.onclick = () => alert("Mobile menu coming soon");

/* Show mobile menu button only on phones */
function adjustMobile() {
  if (window.innerWidth < 760) {
    mobileMenuBtn.style.display = "block";
  } else {
    mobileMenuBtn.style.display = "none";
  }
}
window.onresize = adjustMobile;
adjustMobile();

</script>
</body>
</html>
